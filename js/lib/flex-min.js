Flex={};Flex.currentID=0;Flex.uniqId=function(){return"flexMovieUID"+(++Flex.currentID)};Flex.checkFlashPlayerVersion=function(c,e,d){var b=Flex.getFlashPlayerVersion();if(b===false){return false}var f=Flex.transformVersionToFloat([c,e,d],5);var a=Flex.transformVersionToFloat(b,5);return f<=a};Flex._getFlashPlayerVersionAsActiveX=function(){var a=[{"default":"7.0.0",code:"ShockwaveFlash.ShockwaveFlash.7",variable:true},{"default":"6.0.0",code:"ShockwaveFlash.ShockwaveFlash.6",variable:true,acceess:true},{"default":"3.0.0",code:"ShockwaveFlash.ShockwaveFlash.3",variable:false},{"default":"2.0.0",code:"ShockwaveFlash.ShockwaveFlash",variable:false},];var g=function(h){var e=new ActiveXObject(h.code);if(h.access&&h.variable){e.AllowScriptAccess="always"}if(h.variable){return e.GetVariable("$version")}return h["default"]};var c=false;for(var d=0,b=a.length;d<b;d++){try{c=g(a[d]);return c}catch(f){}}return false};Flex.transformVersionToArray=function(b){if(!Object.isString(b)){return false}var a=b.match(/[\d]+/g);if(a.length>3){return a.slice(0,3)}else{if(a.length){return a}}return false};Flex.transformVersionToFloat=function(c,d){if(Object.isString(c)){c=Flex.transformVersionToArray(c)}if(Object.isArray(c)){var a=0;for(var e=0,b=c.length;e<b;e++){a+=parseFloat(c[e])/Math.pow(10,d*e)}return a}return false};Flex.getFlashPlayerVersion=function(){if(Flex.flashPlayerVersion){return Flex.flashPlayerVersion}var b=false;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.mimeTypes&&navigator.mimeTypes.length>0){if(navigator.mimeTypes["application/x-shockwave-flash"]&&!navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){return false}}var a=navigator.plugins["Shockwave Flash"]||navigator.plugins["Shockwave Flash 2.0"];b=Flex.transformVersionToArray(a.description)}else{b=Flex.transformVersionToArray(Flex._getFlashPlayerVersionAsActiveX())}Flex.flashPlayerVersion=b;return b};Flex.Object=Class.create({initialize:function(a){this.isIE=Prototype.Browser.IE;this.isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;this.attributes={quality:"high",pluginspage:"http://www.adobe.com/go/getflashplayer",type:"application/x-shockwave-flash",allowScriptAccess:"always",classid:"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"};this.bridgeName="";this.bridge=false;this.setAttributes(a);this.applied=false;var b=/(^|.|\r|\n)(\{(.*?)\})/;if(this.detectFlashVersion(9,0,28)){if(this.isIE){this.template=new Template('<object {objectAttributes}><param name="allowFullScreen" value="true"/>{objectParameters}</object>',b)}else{this.template=new Template('<embed {embedAttributes} allowfullscreen="true" />',b)}}else{this.template=new Template("This content requires the Adobe Flash Player.  <a href=http://www.adobe.com/go/getflash/>Get Flash</a>",b)}this.parametersTemplate=new Template('<param name="{name}" value="{value}" />',b);this.attributesTemplate=new Template(' {name}="{value}" ',b)},setAttribute:function(a,b){if(!this.applied){this.attributes[a]=b}},getAttribute:function(a){return this.attributes[a]},setAttributes:function(a){$H(a).each(function(b){this.setAttribute(b.key,b.value)}.bind(this))},getAttributes:function(){return this.attributes},apply:function(a){if(!this.applied){this.setAttribute("id",Flex.uniqId());this.preInitBridge();var b=this.template.evaluate(this.generateTemplateValues());$(a).update(b)}this.applied=true},applyWrite:function(){if(!this.applied){this.setAttribute("id",Flex.uniqId());this.preInitBridge();var a=this.template.evaluate(this.generateTemplateValues());document.write(a)}this.applied=true},preInitBridge:function(){this.bridgeName=this.getAttribute("id")+"bridge";var b=this.getAttribute("flashVars")||this.getAttribute("flashvars")||"";if(b!=""){b+="&"}b+="bridgeName="+this.bridgeName;this.setAttribute("flashVars",b);var a=this;FABridge.addInitializationCallback(this.bridgeName,function(){a.bridge=this.root();a.initBridge()})},initBridge:function(){if(this.onBridgeInit){this.onBridgeInit(this.getBridge())}},getBridge:function(){return this.bridge},generateTemplateValues:function(){var d={embed:{movie:"src",id:"name",flashvars:"flashVars",classid:false,codebase:false},object:{pluginspage:false,src:"movie",flashvars:"flashVars",type:false,inline:["type","classid","codebase","id","width","height","align","vspace","hspace","class","title","accesskey","name","tabindex"]}};var b={};var c={};var e={};$H(this.attributes).each(function(i){var f=i.key.toLowerCase();this.attributes[i.key]=this.escapeAttributes(i.value);var h=(d.object[f]?d.object[f]:f);var g=(d.embed[f]?d.embed[f]:f);if(d.object[f]!==false){if(d.object.inline.indexOf(h)!==-1){c[h]=this.attributes[i.key]}else{e[h]=this.attributes[i.key]}}if(d.embed[f]!==false){b[g]=this.attributes[i.key]}}.bind(this));var a={objectAttributes:"",objectParameters:"",embedAttributes:""};$H(c).each(function(f){a.objectAttributes+=this.attributesTemplate.evaluate({name:f.key,value:f.value})}.bind(this));$H(b).each(function(f){a.embedAttributes+=this.attributesTemplate.evaluate({name:f.key,value:f.value})}.bind(this));$H(e).each(function(f){a.objectParameters+=this.parametersTemplate.evaluate({name:f.key,value:f.value})}.bind(this));return a},escapeAttributes:function(a){if(typeof a=="string"){return a.escapeHTML()}else{return a}},detectFlashVersion:function(a,c,b){return Flex.checkFlashPlayerVersion(a,c,b)}});